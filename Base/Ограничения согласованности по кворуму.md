## Ограничения согласованности по кворуму
aliases: 
	- "ограничения согласованности по кворуму"

---

### Какие ограничения по согласованности у кворуму

Если у вас есть _n_ реплик и параметры _w_ и _r_ подобраны так, что _w + r > n_, это обычно гарантирует, что чтение вернёт последнее записанное значение. Это происходит, поскольку наборы узлов для записи и чтения должны пересекаться. Чтобы выдержать до _n/2_ отказов, обычно _w_ и _r_ выбираются большими, чем _n/2_.

Можно настроить _w_ и _r_ меньше, чтобы _w + r ≤ n_. Это снижает вероятность чтения актуальных данных, но увеличивает доступность системы при сбоях. Например, если много узлов становятся недоступными из-за сетевых проблем, операции могут продолжаться, пока доступно минимальное количество узлов.

Даже при настройке _w + r > n_ возможны ситуации, когда читаются устаревшие значения, например:

- Несовпадение узлов при чтении и записи.
- Параллельные записи, где неясно, какая запись была первой.
- Неодновременное завершение записи на всех узлах.

Даже если запись на некоторых репликах успешна, ошибка на других узлах может вызвать несогласованность данных. Например, если запись не была успешной на всех необходимых узлах, последующие чтения могут вернуть старые значения.

В системах с репликацией без лидера трудно отслеживать задержки репликации из-за отсутствия фиксированного порядка применения записей. Важно отслеживать степень устаревания данных с помощью метрик и предупреждений, чтобы понимать, насколько данные отстают.

---
Tags:
Author: [[]]
Related: [[]]
URL: -- 