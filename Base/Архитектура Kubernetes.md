## О чем эта заметка
aliases: 
	- ""

---

## **Архитектура Kubernetes**

### **Общее устройство**

Kubernetes (K8s) – это **система оркестрации контейнеров**, обеспечивающая автоматическое развертывание, масштабирование и управление контейнеризированными приложениями. Кластер Kubernetes состоит из **Control Plane (управляющий слой)** и **Worker Nodes (рабочие узлы)**.

### **Компоненты управляющего слоя (Control Plane)**

1. **API Server** – основной интерфейс взаимодействия со всеми компонентами через REST API. Обрабатывает запросы, проверяет права (RBAC) и хранит состояние в etcd.
2. **etcd** – распределенное хранилище состояния кластера (хранит манифесты Pod’ов, ConfigMap’ы, Secret’ы и др.). Работает по алгоритму консенсуса RAFT.
3. **Scheduler** – планирует поды на узлы на основе доступных ресурсов и политик (taints/tolerations, affinity/anti-affinity).
4. **Controller Manager** – управляет контроллерами (ReplicaSet, Deployment, StatefulSet и т. д.), следит за соответствием желаемого и реального состояния.
5. **Cloud Controller Manager** (в облачных кластерах) – интеграция с облачными API (например, создание LoadBalancer в AWS/GCP).

### **Компоненты рабочего узла (Worker Node)**

1. **Kubelet** – агент на узле, который запускает и управляет подами. Взаимодействует с API Server, следит за контейнерами, их здоровьем и перезапуском.
2. **Kube Proxy** – реализует сервисную маршрутизацию, балансировку трафика между подами (через iptables или IPVS).
3. **Container Runtime (CRI)** – контейнерная среда выполнения (например, containerd, CRI-O), которая непосредственно запускает контейнеры.

### **Сетевое взаимодействие**

- **Service Discovery** через ClusterIP и DNS (CoreDNS).
- **CNI-плагины (Calico, Flannel, Cilium)** – определяют, как поды взаимодействуют друг с другом.
- **Ingress Controller** – управляет HTTP(S) трафиком (например, NGINX Ingress).

### **Хранилище и Persistent Volumes**

- **PersistentVolume (PV)** и **PersistentVolumeClaim (PVC)** – механизм для выделения постоянного хранилища.
- **StorageClass** – автоматическое выделение PV через CSI-драйверы.

### **Масштабируемость и отказоустойчивость**

- **Horizontal Pod Autoscaler (HPA)** – добавляет/удаляет поды на основе метрик.
- **Cluster Autoscaler** – добавляет/удаляет узлы.
- **Rolling Update & Canary Deployments** – бесшовные обновления.

### **Безопасность**

- **RBAC** – контроль прав доступа.
- **Network Policies** – изоляция сетевого трафика между подами.
- **Подпись контейнерных образов** – проверка целостности перед запуском (Cosign, Sigstore).
---
Tags:
Author: [[]]
Related: [[]]
URL: -- 