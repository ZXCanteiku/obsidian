## Согласованность и консенсус
aliases: 
	- "Как достичь согласованности и консенсуса"

---

### Согласованность и консенсус 


**Согласованность** — свойство распределённой системы, при котором данные во всех узлах выглядят согласованными и соответствуют определённой модели (например, линеаризуемости или причинности).

**Консенсус** — процесс (или набор алгоритмов) в распределённой системе, позволяющий всем узлам согласовать единое, необратимое решение (например, выбрать ведущего узла или зафиксировать транзакцию).

- **[[Линеаризуемость]]**  
    Модель, при которой кажется, что все операции на реплицированных данных происходят последовательно, как если бы существовала только одна копия. Дополнительный материал: [Во что обойдется линеаризуемость в распределенной системе](https://habr.com/ru/companies/vk/articles/793210/)

- **[[Причинность]]**  
    Рассматривает порядок событий «что произошло раньше, а что позже». Допускает конкурентные обновления и ветвления версий, в отличие от жёсткой линеаризуемости.
    
- [[Рассылка общей последовательности]]
    
- **[[Когда требуется консенсус]]**  
    Объяснение, почему некоторые задачи (например, выбор ведущего узла, ограничение уникальности или атомарные транзакции) сводятся к необходимости общего решения среди всех узлов.
    
- **[[Выбор ведущего узла]]**  
    Способы сохранить работоспособность системы, если единственный ведущий узел выходит из строя (ожидание восстановления, ручное вмешательство или автоматический алгоритм консенсуса).
    
- **[[Системы без глобального консенсуса]]**  
    Подходы с несколькими ведущими или вовсе без них. Конфликты здесь решаются путём слияния версий, жертвуя строгой согласованностью.
    
- **[[ZooKeeper]] и другие инструменты**  
    Сервисы, предоставляющие «аутсорсинг» консенсуса, обнаружение сбоев и сервис членства, чтобы приложения не писали собственные алгоритмы с нуля.
    
- **Теория распределённых систем**  
	- **CAP** (Brewera): нельзя одновременно иметь (C) сильную согласованность и (A) доступность при сетевых разрывах (P). Если сеть «ломается», приходится либо «отключаться», либо выдавать слабую согласованность.
	- **Теорема FLP**: в асинхронной сети (без верхних границ на задержки) нельзя гарантировать детектирование отказов и достичь консенсуса полностью надёжно, если узел может «зависнуть» (крайний случай). На практике же берут временные таймауты и кворумы.
	- **[[2PC]] и [[3PC]]**: классические алгоритмы. Двухфазная фиксация (2PC) умеет атомарно фиксировать транзакции, но блокируется, если координатор упал. Трёхфазная (3PC) в реальных сетях с неограниченными задержками плохо защищена от сбоев.
	- **[[Paxos]], [[Raft]], [[Zab]]**: современные алгоритмы консенсуса, которые обходят проблему «блокировки координатора», используя механизмы выбора лидера и кворумы. Позволяют продолжать работу, если хотя бы большинство узлов активно. ([[Консенсусные протоколы]])

---
Tags: #highLoad #develop #coherence  #consensus
Author: [[]]
Related: [[Высоконагруженные приложения]]
URL: -- 