## Lifecycle
aliases: 
	- "Lifecycle"

### Жизненный цикл сущности в jpa and Hibernate

![[Pasted image 20241214190211.png]]

#### Transient 
**Описание:** Сущность находится в транзиентном состоянии, когда она создана с помощью оператора `new`, но еще не связана с контекстом персистентности (`EntityManager`). В этом состоянии объект не имеет привязки к базе данных и не отслеживается JPA.
**Характеристики:**
- **Нет идентификатора:** Поле, аннотированное `@Id`, еще не заполнено.
- **Не отслеживается контекстом персистентности:** Любые изменения объекта не будут автоматически сохранены в базе данных.
- **Не привязана к базе данных:** Объект не представлен ни одной строкой в базе данных.
#### Managed
**Описание:** Сущность становится управляемой, когда она связана с контекстом персистентности (`EntityManager`). В этом состоянии JPA отслеживает изменения объекта и автоматически синхронизирует их с базой данных при выполнении транзакции.
**Характеристики:**
- **Присвоен идентификатор:** Обычно при сохранении объекта генерируется и присваивается значение первичного ключа (`@Id`).
- **Отслеживаются изменения:** Любые изменения объекта будут автоматически отражены в базе данных.
- **Связана с контекстом персистентности:** Объект ассоциирован с конкретным `EntityManager`.
#### Detached
**Описание:** Сущность переходит в отсоединённое состояние, когда она больше не связана с контекстом персистентности. Это может произойти после закрытия `EntityManager`, завершения транзакции или явного отсоединения объекта.
**Характеристики:**
- **Сохранён в базе данных:** Объект был сохранён ранее, но сейчас не отслеживается.
- **Изменения не отслеживаются:** Любые изменения объекта не будут автоматически сохранены в базе данных.
- **Может быть повторно присоединена:** Сущность может быть снова связана с контекстом персистентности с помощью метода `merge`.
#### Removed
**Описание:** Сущность находится в удалённом состоянии, когда она помечена для удаления из базы данных. После завершения транзакции объект будет удалён из базы данных.
**Характеристики:**
- **Помечена для удаления:** Вызывается метод `remove`.
- **Будет удалена из базы данных при завершении транзакции.**
- **Сразу после удаления объект переходит в удалённое состояние.**



- [[Entityt Manager, Session]]



---
Tags: #entity
Author: [[]]
Related: [[JDBC, ORM, JPA and Hibernate]]
URL: [[]]