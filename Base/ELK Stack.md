## ELK Stack
aliases: 
	- "ELK Stack"
	
---
**ELK Stack** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π —Å—Ç–µ–∫ –¥–ª—è **—Å–±–æ—Ä–∞, —Ö—Ä–∞–Ω–µ–Ω–∏—è, –ø–æ–∏—Å–∫–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤**. –û–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:
- **Elasticsearch** ‚Äì –•—Ä–∞–Ω–∏—Ç –∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –ª–æ–≥–∏.
- **Logstash** ‚Äì –°–æ–±–∏—Ä–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–æ–≥–∏.
- **Kibana** ‚Äì –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ª–æ–≥–∏.
- **Filebeat** –∏–ª–∏ **fluentbit** (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ) ‚Äì –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏ –≤ Logstash/Elasticsearch.

### **1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ELK –≤ Kubernetes –∏ Java?**
–í **Kubernetes** ELK –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**:
1. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ K8s** –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –ª–æ–≥–∏ (stdout, stderr, —Ñ–∞–π–ª—ã).
2. **Filebeat** –∏–ª–∏ **fluentbit** —Å–æ–±–∏—Ä–∞–µ—Ç –ª–æ–≥–∏ —Å –ø–æ–¥–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ **Logstash**.
3. **Logstash** —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç, –ø–∞—Ä—Å–∏—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ **Elasticsearch**.
4. **Elasticsearch** –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –ª–æ–≥–∏ –∏ —Ö—Ä–∞–Ω–∏—Ç –∏—Ö.
5. **Kibana** –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ.

üìå **–ü–æ—á–µ–º—É Filebeat?**
- –õ–µ–≥—á–µ, —á–µ–º Logstash.
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ K8s –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–±–∏—Ä–∞–µ—Ç –ª–æ–≥–∏ —Å –ø–æ–¥–æ–≤.
### **2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ELK –≤ Kubernetes**
–£—Å—Ç–∞–Ω–æ–≤–∏–º **Elasticsearch + Kibana + Filebeat** —Å –ø–æ–º–æ—â—å—é **Helm**.
### **3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Filebeat –¥–ª—è —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
üìå **–°–æ–∑–¥–∞–¥–∏–º `filebeat-config.yaml`**:
```yaml
filebeat.inputs:
  - type: container
    paths:
      - "/var/log/containers/*.log"
    processors:
      - add_kubernetes_metadata:
          in_cluster: true

output.elasticsearch:
  hosts: ["http://elasticsearch:9200"]
```

### **4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Logstash (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
–ï—Å–ª–∏ –ª–æ–≥–∏ **–Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç), Logstash –ø–æ–º–æ–≥–∞–µ—Ç **–ø–∞—Ä—Å–∏—Ç—å –∏—Ö**.
**–°–æ–∑–¥–∞—ë–º `logstash.conf`**:
```sh
input {
  beats {
    port => 5044
  }
}

filter {
  grok {
    match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:level} %{GREEDYDATA:message}" }
  }
}

output {
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
  }
}
```

### **5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å ELK**
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Logback + JSON

### **6. –ö–∞–∫ ELK —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞?**
‚úÖ **–°–±–æ—Ä –ª–æ–≥–æ–≤ –∏–∑ Kubernetes (stdout, stderr)**  
‚úÖ **–ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫, –∏—Å–∫–ª—é—á–µ–Ω–∏–π –≤ Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö**  
‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ª–æ–≥–æ–≤ (–∑–∞–ø—Ä–æ—Å—ã, –Ω–∞–≥—Ä—É–∑–∫–∞, –∑–∞–¥–µ—Ä–∂–∫–∏)**  
‚úÖ **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –∏ –∞–ª–µ—Ä—Ç—ã**

### **–í–æ–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏**
**1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç ELK Stack?**
- Logstash/Filebeat —Å–æ–±–∏—Ä–∞–µ—Ç –ª–æ–≥–∏ ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Elasticsearch ‚Üí Kibana –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç.
**2. –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä –ª–æ–≥–æ–≤ –≤ Kubernetes?**
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **Filebeat**, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `/var/log/containers/*.log`.
**3. –ö–∞–∫ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å Java –≤ ELK?**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Logback + LogstashEncoder**.
**4. –ö–∞–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –≤ Logstash?**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Grok-—Ñ–∏–ª—å—Ç—Ä—ã**.
**5. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Logstash –∏ Filebeat?**
- **Logstash** –ø–∞—Ä—Å–∏—Ç —Å–ª–æ–∂–Ω—ã–µ –ª–æ–≥–∏, **Filebeat** –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç.



---
Tags: #infrastructure #elk
Author: [[]]
Related: [[–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Java]]
URL: -- 