## Entityt Manager, Session
aliases: 
	- "Entityt Manager, Session"


### EntityManager и Session
- **EntityManager**: Интерфейс JPA, предоставляющий API для взаимодействия с базой данных (CRUD-операции, управление жизненным циклом сущностей и т.д.).
- **Session**: Интерфейс Hibernate, предоставляющий доступ к базовым возможностям Hibernate (работа с сущностями, кэширование, транзакции и т.д.).
Они оба служат для управления **Persistence Context**, но Session — это конкретная реализация Hibernate, а EntityManager — стандарт JPA.

### Когда создается/закрывается контекст
1. **Вручную**:
    - Вы создаете `EntityManager` или `Session` вручную, вызывая соответствующий метод фабрики.
    - Контекст персистентности существует до тех пор, пока `EntityManager` или `Session` открыт.
2. **Автоматически** (например, с использованием Spring):
    - Контекст персистентности создается и управляется контейнером в пределах транзакции.

### Как Hibernate отслеживает изменения
1. **Управляемые сущности**:
    - Hibernate сохраняет "снимок" (snapshot) начального состояния управляемых сущностей.
    - При вызове **flush** сравниваются текущие и начальные состояния.
    - Изменения автоматически генерируют SQL для синхронизации с базой данных.
2. **Dirty Checking**:
    - При каждом изменении свойств управляемой сущности Hibernate отслеживает их и определяет, нужно ли обновлять базу данных.



---
Tags: #entity
Author: [[]]
Related: [[JDBC, ORM, JPA and Hibernate]]
URL: [[]]