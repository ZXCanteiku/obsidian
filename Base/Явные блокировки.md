## Явные блокировки
aliases: 
	- "явные блокировки"

---

### Явные блокировки

Если атомарных операций недостаточно, объекты можно явно блокировать для безопасного выполнения цикла чтения-изменения-записи. Например, в многопользовательской игре, где игроки могут двигать одну фигуру, блокировки позволяют предотвратить одновременное перемещение фигур несколькими пользователями:

```sql
BEGIN TRANSACTION; 
SELECT * FROM figures WHERE name = 'robot' AND game_id = 222 FOR UPDATE; UPDATE figures SET position = 'c4' WHERE id = 1234; 
COMMIT;
```

Предложение `FOR UPDATE` блокирует строки, возвращенные запросом, предотвращая состояние гонки.

---
Tags: #transactions #highLoad
Author: [[]]
Related: [[Предотвращение потери обновлений]]
URL: -- 