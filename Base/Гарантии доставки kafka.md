## Гарантии доставки kafka
aliases: 
	- ""

---
 - **At most once**: Сообщения могут быть потеряны, но дубликатов не будет.
	 ![[Pasted image 20250307200901.png]]
	 ack - 0
 - **At least once**: Сообщение точно будет доставлено, но возможны дубликаты (если консьюмер завершился до коммита offset).
	 ![[Pasted image 20250307202151.png]]
	- ask - all
	 - Отправитель повторно отправляет сообщение, если не получает подтверждение от получателя.
	- Возможны **дубликаты**, но данные не теряются.
	- Требует **механизма дедупликации** на стороне получателя.
	- Применение:
	    - Kafka с авто-повторами (`enable.auto.commit=false`).
	    - Email/Push-уведомления (лучше продублировать, чем потерять).
	    - В платежных системах с идемпотентными операциями.
- **Exactly once**: Достигается за счет идемпотентности продюсера и транзакций (например, запись в Kafka и внешнюю БД в одной транзакции).
	- Требует **транзакционной обработки** или **идемпотентных операций**.
	- Используется **distributed transactions**, **idempotency keys**, или **Kafka Transactions API**.
	- Применение:
	    - Финансовые системы (переводы, платежи).
	    - Обновления состояния в базе данных.
	    - Сложные цепочки обработки сообщений.
---
Tags: #infrastructure #kafka
Author: [[]]
Related: [[Apache Kafka]]
URL: -- 